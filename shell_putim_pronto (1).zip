<!doctype html>

<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Shell Putim – Painel Admin + Área do Cliente (Protótipo)</title>
  <style>
    :root{
      --red:#D40000;
      --yellow:#FFC300;
      --bg:#0f0f12;
      --card:#17181c;
      --muted:#888;
      --ok:#11b37a;
      --warn:#d46a00;
      --error:#e03636;
      --radius:16px;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif;background:linear-gradient(180deg,#0b0b0e,#131318);color:#fff}
    header{display:flex;gap:14px;align-items:center;justify-content:space-between;padding:18px 20px;border-bottom:1px solid #222;background:linear-gradient(180deg,#15161c,#121319)}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:42px;height:42px;border-radius:12px;background:radial-gradient(circle at 30% 30%,var(--yellow),#ffd761 40%,#fff 41%, var(--red) 42%);box-shadow:0 0 0 2px #fff2 inset, 0 10px 20px #0008}
    .title{font-weight:800;letter-spacing:.2px}
    .subtitle{color:#ccc;font-size:12px}.tabs{display:flex;gap:8px;flex-wrap:wrap}
.tab-btn{appearance:none;border:1px solid #2a2b33;background:#191a21;color:#fff;padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:600}
.tab-btn.active{background:linear-gradient(180deg,var(--red),#a90000);border-color:#a90000}

main{max-width:1200px;margin:24px auto;padding:0 16px 56px;display:grid;grid-template-columns:1fr;gap:16px}
.grid{display:grid;gap:16px}
.grid.two{grid-template-columns:1fr}
@media (min-width:960px){.grid.two{grid-template-columns:1fr 1fr}}

.card{background:linear-gradient(180deg,#181a22,#13141a);border:1px solid #262735;border-radius:var(--radius);padding:16px;box-shadow:0 10px 30px #0006}
.card h2{margin:0 0 8px;font-size:18px}
.card h3{margin:14px 0 8px;font-size:16px;color:#ddd}
.muted{color:#aaa;font-size:13px}
label{display:block;margin:8px 0 6px;font-size:13px;color:#ddd}
input,select,textarea{width:100%;padding:10px 12px;border-radius:10px;border:1px solid #2a2c36;background:#12131a;color:#fff}
input[type="number"]{appearance:textfield}
button{appearance:none;border:none;background:linear-gradient(180deg,#2a2b33,#1a1b22);color:#fff;padding:10px 14px;border-radius:12px;cursor:pointer;font-weight:700}
button.primary{background:linear-gradient(180deg,var(--yellow),#d7a600);color:#000}
button.danger{background:linear-gradient(180deg,#451517,#2a0e0f);border:1px solid #6f1d21}
button.success{background:linear-gradient(180deg,#0d4,#0a5);color:#04140f}
.row{display:flex;gap:10px;flex-wrap:wrap}
.row > *{flex:1 1 180px}
.table{width:100%;border-collapse:collapse;border-radius:12px;overflow:hidden}
.table th,.table td{border-bottom:1px solid #262735;padding:10px 8px;text-align:left;font-size:14px}
.badge{display:inline-block;padding:2px 8px;border-radius:999px;font-size:12px;border:1px solid #2a2c36;background:#111}
.badge.ok{border-color:#0a5;color:#9ff3d0}
.badge.warn{border-color:#d7a600;color:#ffe680}
.badge.err{border-color:#a90000;color:#ffb3b3}
.hint{font-size:12px;color:#9da3af}
.right{display:flex;gap:8px;align-items:center}
.spacer{height:8px}
.divider{height:1px;background:#242633;margin:12px 0}
.kpi{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
.kpi .card{background:linear-gradient(180deg,#1a1d25,#13141a)}
.kpi .value{font-size:24px;font-weight:800}
.kpi .label{font-size:12px;color:#bbb}
.footer{max-width:1200px;margin:0 auto 24px;padding:0 16px;color:#9aa}
.whats{color:#25D366;text-decoration:none;font-weight:700}

  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="logo" aria-hidden="true"></div>
      <div>
        <div class="title">Shell Putim</div>
        <div class="subtitle">Programa de Pontos & Recompensas</div>
      </div>
    </div>
    <div class="tabs">
      <button class="tab-btn active" data-tab="cliente">Área do Cliente</button>
      <button class="tab-btn" data-tab="admin">Painel Admin</button>
    </div>
  </header>  <main>
    <section class="kpi" id="kpis" hidden>
      <div class="card"><div class="value" id="kpiClientes">0</div><div class="label">Clientes</div></div>
      <div class="card"><div class="value" id="kpiPontos">0</div><div class="label">Pontos totais</div></div>
      <div class="card"><div class="value" id="kpiVouchers">0</div><div class="label">Vouchers emitidos</div></div>
    </section><section class="card" id="tab-cliente">
  <h2>Área do Cliente</h2>
  <p class="muted">Consulte seus pontos e resgate recompensas.
    <span class="right"><a class="whats" target="_blank" href="https://wa.me/5535991802969">WhatsApp do posto: +55 35 99180-2969</a></span>
  </p>
  <div class="divider"></div>
  <div class="grid two">
    <div>
      <h3>Entrar</h3>
      <div class="row">
        <div>
          <label>CPF (ou Doc.)</label>
          <input id="cliDoc" placeholder="Somente números" inputmode="numeric" />
        </div>
        <div>
          <label>Telefone/WhatsApp</label>
          <input id="cliPhone" placeholder="(DDD) 9XXXX-XXXX" />
        </div>
      </div>
      <div class="spacer"></div>
      <button class="primary" id="btnClienteLogin">Ver meus pontos</button>
      <div class="spacer"></div>
      <div class="hint">Dica: peça seu CPF no caixa a cada abastecimento para somar pontos automaticamente.</div>
    </div>

    <div>
      <h3>Meu saldo & recompensas</h3>
      <div id="clienteInfo" class="muted">Faça login para ver seus dados.</div>
      <div class="spacer"></div>
      <table class="table" id="rewardsCliente" hidden>
        <thead>
          <tr><th>Recompensa</th><th>Pontos</th><th>Status</th><th>Ação</th></tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</section>

<section class="card" id="tab-admin" hidden>
  <h2>Painel Administrativo</h2>
  <p class="muted">Cadastre clientes, registre abastecimentos e gerencie recompensas. <span class="badge warn">Protótipo local (LocalStorage)</span></p>
  <div class="divider"></div>

  <div class="grid two">
    <div class="card">
      <h3>Cadastro de Cliente</h3>
      <div class="row">
        <div><label>Nome</label><input id="admNome" placeholder="Ex.: Maria Silva"></div>
        <div><label>CPF (ou Doc.)</label><input id="admDoc" placeholder="Somente números" inputmode="numeric"></div>
        <div><label>Telefone/WhatsApp</label><input id="admPhone" placeholder="(DDD) 9XXXX-XXXX"></div>
      </div>
      <div class="spacer"></div>
      <button class="primary" id="btnAddCliente">Salvar cliente</button>
      <div class="spacer"></div>
      <table class="table" id="tblClientes">
        <thead><tr><th>Nome</th><th>Doc</th><th>Telefone</th><th>Pontos</th><th></th></tr></thead>
        <tbody></tbody>
      </table>
    </div>

    <div class="card">
      <h3>Registrar Abastecimento</h3>
      <div class="row">
        <div>
          <label>Cliente</label>
          <select id="abCliente"></select>
        </div>
        <div>
          <label>Combustível</label>
          <select id="abTipo">
            <option value="gasolina_aditivada">Gasolina aditivada (2 pts/L)</option>
            <option value="gasolina_comum">Gasolina comum (1.5 pts/L)</option>
            <option value="etanol">Álcool / Etanol (1 pt/L)</option>
            <option value="diesel">Diesel (1.2 pts/L)</option>
          </select>
        </div>
        <div>
          <label>Litros</label>
          <input type="number" id="abLitros" step="0.01" min="0" placeholder="Ex.: 25" />
        </div>
        <div>
          <label>Data</label>
          <input type="date" id="abData" />
        </div>
      </div>
      <div class="spacer"></div>
      <button class="success" id="btnAddAbastecimento">Registrar & Pontuar</button>
      <div class="spacer"></div>
      <table class="table" id="tblAbastecimentos">
        <thead><tr><th>Data</th><th>Cliente</th><th>Tipo</th><th>Litros</th><th>Pontos gerados</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </div>

  <div class="grid two">
    <div class="card">
      <h3>Recompensas (configuráveis)</h3>
      <p class="hint">Ative/desative e ajuste a pontuação. Ex.: energético 40, refrigerante 30 etc.</p>
      <table class="table" id="tblRewardsCfg">
        <thead><tr><th>Item</th><th>Pontos</th><th>Ativo</th></tr></thead>
        <tbody></tbody>
      </table>
      <div class="spacer"></div>
      <button id="btnAddReward">+ Adicionar recompensa</button>
    </div>

    <div class="card">
      <h3>Vouchers emitidos</h3>
      <table class="table" id="tblVouchers">
        <thead><tr><th>Data</th><th>Código</th><th>Cliente</th><th>Item</th><th>Pontos</th><th>Status</th><th>Ações</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</section>

  </main>  <div class="footer">
    <div>Contato do posto (WhatsApp): <a class="whats" target="_blank" href="https://wa.me/5535991802969">+55 35 99180-2969</a></div>
    <div class="hint">Protótipo local. Próximo passo: conectar ao banco (Supabase), autenticação e PWA.</div>
  </div>  <template id="tplComprovante">
    <div style="font-family:Arial, sans-serif; width:280px; padding:12px">
      <div style="font-weight:800; font-size:16px;">Shell Putim – Comprovante de Resgate</div>
      <div style="font-size:12px;color:#333;margin:6px 0 10px">Apresente este comprovante com documento antes do pagamento da notinha.</div>
      <div style="border:1px dashed #333; padding:8px; border-radius:8px">
        <div><b>Cliente:</b> <span data-k="nome"></span></div>
        <div><b>Documento:</b> <span data-k="doc"></span></div>
        <div><b>Item:</b> <span data-k="item"></span></div>
        <div><b>Pontos debitados:</b> <span data-k="pontos"></span></div>
        <div><b>Código:</b> <span data-k="codigo"></span></div>
        <div><b>Data:</b> <span data-k="data"></span></div>
      </div>
      <div style="margin-top:10px; font-size:11px; color:#444">Código único. Válido para 7 dias. Resgate mediante documento.</div>
    </div>
  </template>  <script>
    const DB_KEY = 'shell_putim_db_v1';
    const dbDefault = {
      clientes: [
        { id: cid(), nome: 'Cliente Exemplo', doc: '00000000191', phone: '(35) 99180-2969', pontos: 120 },
      ],
      abastecimentos: [],
      rewards: [
        { id: rid(), item: 'Energético', pontos: 40, ativo: true },
        { id: rid(), item: 'Refrigerante', pontos: 30, ativo: true },
        { id: rid(), item: 'Cerveja', pontos: 50, ativo: false },
        { id: rid(), item: 'Biscoito', pontos: 20, ativo: true },
        { id: rid(), item: 'Halls', pontos: 15, ativo: true },
        { id: rid(), item: 'Chiclete', pontos: 10, ativo: true },
        { id: rid(), item: 'Lavagem', pontos: 100, ativo: true },
      ],
      vouchers: []
    };
    let db = load();

    function load(){
      try{
        const raw = localStorage.getItem(DB_KEY);
        if(!raw){
          localStorage.setItem(DB_KEY, JSON.stringify(dbDefault));
          return structuredClone(dbDefault);
        }
        return JSON.parse(raw);
      }catch(e){
        console.error(e); return structuredClone(dbDefault);
      }
    }
    function save(){ localStorage.setItem(DB_KEY, JSON.stringify(db)); }

    function cid(){ return 'C' + Math.random().toString(36).slice(2,9).toUpperCase(); }
    function rid(){ return 'R' + Math.random().toString(36).slice(2,9).toUpperCase(); }
    function vcode(){ return 'VCH-' + Date.now().toString(36).toUpperCase() + '-' + Math.random().toString(36).slice(2,6).toUpperCase(); }

    function pontosPorLitro(tipo){
      switch(tipo){
        case 'gasolina_aditivada': return 2.0;
        case 'gasolina_comum': return 1.5;
        case 'etanol': return 1.0;
        case 'diesel': return 1.2;
        default: return 1.0;
      }
    }

    const $ = sel => document